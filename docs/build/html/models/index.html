
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Models &#8212; Tensorflow Few-Shot 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Welcome" href="../index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Welcome"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Tensorflow Few-Shot 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Models</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-tensorflow_fewshot.models">
<span id="models"></span><h1>Models<a class="headerlink" href="#module-tensorflow_fewshot.models" title="Permalink to this headline">¶</a></h1>
<p>A collection of few-shot models.</p>
<div class="section" id="prototypical-networks">
<h2>Prototypical Networks<a class="headerlink" href="#prototypical-networks" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="tensorflow_fewshot.models.PrototypicalNetwork">
<em class="property">class </em><code class="sig-prename descclassname">tensorflow_fewshot.models.</code><code class="sig-name descname">PrototypicalNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">encoder</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.PrototypicalNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements Prototypical Networks from the original paper (Snell et al., 2017).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>encoder</strong> (<em>tf.keras.Model</em>) – The encoder used to map the image onto the metric space. Make sure that the input
shape is defined, otherwise the model can’t infer the output shape at initialization, which is required in
later computations.</p>
</dd>
</dl>
<dl class="py method">
<dt id="tensorflow_fewshot.models.PrototypicalNetwork.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_X</span></em>, <em class="sig-param"><span class="n">train_Y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.PrototypicalNetwork.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the model to the data.</p>
<p>Computes the prototype of each class and the internal mapping between prototype index
and label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_X</strong> (<em>numpy.array</em>) – An array containing training data, of shape [nb_samples, [model_input_shape]].</p></li>
<li><p><strong>train_Y</strong> (<em>numpy.array</em>) – The corresponding labels, a 1-dimensional array of integers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="tensorflow_fewshot.models.PrototypicalNetwork.meta_train">
<code class="sig-name descname">meta_train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_train_X</span></em>, <em class="sig-param"><span class="n">meta_train_Y</span></em>, <em class="sig-param"><span class="n">meta_val_X</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_val_Y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_episode</span><span class="o">=</span><span class="default_value">8000</span></em>, <em class="sig-param"><span class="n">n_way</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">ks_shots</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">kq_shots</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'Adam'</span></em>, <em class="sig-param"><span class="n">logging_interval</span><span class="o">=</span><span class="default_value">200</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.PrototypicalNetwork.meta_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model on the meta-training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_train_X</strong> (<em>numpy.array</em>) – The data set used for meta-training.</p></li>
<li><p><strong>meta_train_Y</strong> (<em>numpy.array</em>) – The corresponding set of labels, must be a single dimension array of integers</p></li>
<li><p><strong>meta_val_X</strong> (<em>numpy.array</em>) – A validation set to track the performance of the model every few episodes.</p></li>
<li><p><strong>meta_val_Y</strong> (<em>numpy.array</em>) – The corresponding set of validation labels.</p></li>
<li><p><strong>n_episode</strong> (<em>int</em>) – Number of episodes for meta-training.</p></li>
<li><p><strong>n_way</strong> (<em>int</em>) – Number of ways (or classes per episode).</p></li>
<li><p><strong>ks_shots</strong> (<em>int</em>) – Number of image per class in the support set.</p></li>
<li><p><strong>kq_shots</strong> (<em>int</em>) – Number of image per class in the query set.</p></li>
<li><p><strong>optimizer</strong> (<em>tf.keras.optimizer</em>) – A valid Keras optimizer for training.</p></li>
<li><p><strong>logging_interval</strong> (<em>int</em>) – log and display metrics every ‘logging_interval‘ episodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>acc (list(float)): history of accuracy logged every ‘logging_interval‘ episodes.</p></li>
<li><p>loss (list(float)): history of loss logged every ‘logging_interval‘ episodes.</p></li>
<li><p>test_acc (list(float)): history of vaidation accuracy logged every ‘logging_interval‘ episodes.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3-tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="tensorflow_fewshot.models.PrototypicalNetwork.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.PrototypicalNetwork.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes predictions and return the inferred labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>numpy.array</em>) – An array containing the data to label, of shape [nb_samples, [model_input_shape]].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The predicted label for each data point, a 1-dimensional array of integers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>preds (numpy.array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tensorflow_fewshot.models.utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-tensorflow_fewshot.models.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="tensorflow_fewshot.models.utils.create_imageNetCNN">
<code class="sig-prename descclassname">tensorflow_fewshot.models.utils.</code><code class="sig-name descname">create_imageNetCNN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_shape</span></em>, <em class="sig-param"><span class="n">nb_hidden_layers</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">nb_filters</span><span class="o">=</span><span class="default_value">64</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.utils.create_imageNetCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Keras Sequential Model as described in Matching Nets paper (Vinyals et al., 2016).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>int tuple</em>) – the shape of inputs passed to the model, usually (im_width, im_height, nb_channel).</p></li>
<li><p><strong>nb_hidden_layers</strong> (<em>int</em>) – the number of convolutional blocks (conv2D, batchNorm, ReLU).</p></li>
<li><p><strong>nb_filters</strong> (<em>int</em>) – the number of filters output by each Conv2D layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tensorflow_fewshot.models.utils.euclidean_distance">
<code class="sig-prename descclassname">tensorflow_fewshot.models.utils.</code><code class="sig-name descname">euclidean_distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototypes</span></em>, <em class="sig-param"><span class="n">embeddings</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensorflow_fewshot.models.utils.euclidean_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance of each embedding to each prototype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prototypes</strong> (<em>numpy.array</em>) – a (nb_prototypes, embedding_size)-shaped array.</p></li>
<li><p><strong>embeddings</strong> (<em>numpy.array</em>) – a (nb_embeddings, embedding_size)-shaped array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A (nb_prototypes, nb_embeddings)-shaped array containing the euclidean distance of each embedding to each
prototype.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Models</a><ul>
<li><a class="reference internal" href="#prototypical-networks">Prototypical Networks</a></li>
<li><a class="reference internal" href="#module-tensorflow_fewshot.models.utils">Utils</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../index.html"
                        title="previous chapter">Welcome</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/models/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Welcome"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Tensorflow Few-Shot 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Models</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Aymeric QUESNE.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>